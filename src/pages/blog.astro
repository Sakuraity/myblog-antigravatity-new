---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="博客 | Kangyuan's Blog">
	<div class="max-w-2xl mx-auto py-12">
		<h1 class="font-serif text-4xl font-bold mb-12 text-center">Blog</h1>
		
		<section class="flex flex-col gap-12">
			{posts.map((post) => (
				<article class="group relative flex flex-col items-start space-y-2">
					<div class="flex items-center gap-3 text-xs font-medium tracking-widest uppercase text-text-muted-light dark:text-text-muted-dark">
						<time datetime={post.data.pubDate.toISOString()}>
							{post.data.pubDate.toLocaleDateString('zh-CN', {
								year: 'numeric',
								month: 'long',
								day: 'numeric',
							})}
						</time>
						{post.data.category && (
							<>
								<span class="w-px h-3 bg-gray-300 dark:bg-gray-700"></span>
								<span class="text-primary">{post.data.category}</span>
							</>
						)}
					</div>
					<h2 class="text-2xl font-serif font-bold text-text-light dark:text-text-dark group-hover:text-primary transition-colors">
						<a href={`/posts/${post.slug}/`}>
							<span class="absolute inset-0"></span>
							{post.data.title}
						</a>
					</h2>
					<p class="text-base text-text-muted-light dark:text-text-muted-dark line-clamp-2">
						{post.data.description}
					</p>
					{post.data.tags && post.data.tags.length > 0 && (
						<div class="flex flex-wrap gap-2 pt-2 relative z-10">
							{post.data.tags.map((tag) => (
								<a href={`/tags/${tag}`} class="text-xs font-medium text-text-muted-light dark:text-text-muted-dark bg-gray-100 dark:bg-white/5 px-2 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-white/10 transition-colors duration-200">
									#{tag}
								</a>
							))}
						</div>
					)}

				</article>
			))}
		</section>
	</div>
</Layout>
